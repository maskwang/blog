---
title: 'php利用curl函数抓取https的内容  '
id: 320
categories:
  - Php
  - 技术专栏
  - 编程语言
date: 2011-09-15 04:27:03
tags:
---

直接用file_get_contents，会报错；

程序代码$url = (https://xxx.com");
file_get_contents($url);

错误：
程 序代码Warning: file_get_contents(https://xxx.com) [function.file-get-contents]: failed to open stream: No such file or directory in D:wampwwwgrabber_clientindex.php on line 3

php手册里有相关警告:

当使用 SSL 时，Microsoft IIS 将违反协议不发送 close_notify 标记就关闭连接。PHP 将在到达数据尾端时报告 "SSL: Fatal Protocol Error"。要绕过此问题，应将 error_reporting 级别降低为不包括警告。PHP 4.3.7 及更高版本可以在当使用 https:// 封装协议打开流的时候检测出有此问题的 IIS 服务器并抑制警告。如果使用 fsockopen() 来创建一个 ssl:// 套接字，则需要自己检测并抑制警告信息。

用curl的方式是可以的：
程序代码$url = (https://xxx.com);
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
$result = curl_exec($ch);
print_r($result);

&nbsp;

$status = curl_getinfo($curlHandle, CURLINFO_HTTP_CODE);

echo $status;//HTTP状态

?&gt;

重点是以下两句：
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);