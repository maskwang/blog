---
title: '使用Redis 做队列服务器 '
id: 490
categories:
  - Redis
  - 技术专栏
  - 缓存技术
date: 2012-02-07 16:13:16
tags:
---

## Redis介绍

Reids是一个比较高级的开源key-value存储系统，采用ANSI C实现。其与memcached类似，但是支持持久化数据存储，同时value支持多种类型：**字符串** （同memcached中的value），**列表** ，**集合** (Set)，**有序集合**(OrderSet)和**Hash** 。所有的值类型均支持原子操作，如列表中追加弹出元素，集合中插入移除元素等。Rdids的数据大部分位于内存中，其读写效率非常高，其提供AOF（追加 式操作记录文件）和DUMP（定期数据备份）两种持久化方式。Redis支持自定义的VM（虚拟内存）机制，当数据容量超过内存时，可以将部分Value 存储到文件中。同时Redis支持Master-Slave机制，可以进行数据复制。

可以<span>把_Redis_的list结构当_队列_来用.</span>

**安装过程**
1.安装定制源
<wbr> <wbr>安装#rpm -Uvh [http://os.69hn.com/custom.rpm](http://os.69hn.com/custom.rpm)
<wbr>
2.安装redis
# yum -y <wbr> install redis

3\. 启动：
#service redis start

接着安装php的下redis的扩展包,
#yum -y install php-redis

入队列操作文件 list_push.php

&lt;?php
$redis = new Redis();
$redis-&gt;connect('127.0.0.1', 6379);
while (true) {
<wbr>  <wbr> $redis-&gt;lPush('list1', 'A_'.date('Y-m-d H:i:s'));
<wbr>  <wbr> sleep(rand()%3);
}
?&gt;

执行# php list_push.php &amp;

出队列操作 list_pop.php文件
&lt;?php
$redis = new Redis();
$redis-&gt;pconnect('127.0.0.1', 6379);
while(true) {
<wbr>  <wbr> try {
<wbr>  <wbr> <wbr>  <wbr> <wbr> <wbr>var_export( $redis-&gt;blPop('list1', 10) );
<wbr>  <wbr> } catch(Exception $e) {
<wbr>  <wbr> <wbr>  <wbr> <wbr> <wbr>//echo $e; <wbr>  <wbr>
<wbr>  <wbr> }
}
就是这么简单的一段代码,就搞定了</wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr>